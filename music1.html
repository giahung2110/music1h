<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Web Nghe Nh·∫°c YouTube 1 Gi·ªù</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            margin: 0;
            height: 100vh;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            color: #fff;
        }

        .box {
            background: rgba(0, 0, 0, 0.6);
            padding: 25px;
            border-radius: 14px;
            width: 360px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        h2 {
            margin-bottom: 15px;
        }

        input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: none;
            outline: none;
            margin-bottom: 15px;
            font-size: 14px;
        }

        button {
            padding: 10px 14px;
            margin: 5px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .play { background: #1db954; color: #000; }
        .replay { background: #ffb703; color: #000; }
        .stop { background: #e63946; color: #fff; }

        #status {
            margin-top: 12px;
            font-size: 14px;
            opacity: 0.9;
        }

        /* ·∫®n video */
        #player {
            position: absolute;
            width: 1px;
            height: 1px;
            left: -9999px;
            top: -9999px;
        }
    </style>
</head>
<body>

<div class="box">
    <h2>üéß Web Nghe Nh·∫°c 1 Gi·ªù</h2>

    <input id="ytLink" type="text" placeholder="D√°n link YouTube v√†o ƒë√¢y">

    <div>
        <button class="play" onclick="startMusic()">‚ñ∂ B·∫Øt ƒë·∫ßu ph√°t</button>
        <button class="replay" onclick="replayMusic()">üîÅ Ph√°t l·∫°i</button>
        <button class="stop" onclick="stopMusic()">‚èπ D·ª´ng</button>
    </div>

    <div id="status">‚è≥ Ch∆∞a ph√°t</div>
</div>

<div id="player"></div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
    let player;
    let stopTimer;

    function extractVideoId(url) {
        const regExp = /(?:youtube\.com\/.*v=|youtu\.be\/)([^&]+)/;
        const match = url.match(regExp);
        return match ? match[1] : null;
    }

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '1',
            width: '1',
            videoId: '',
            playerVars: {
                autoplay: 0,
                controls: 0,
                mute: 0
            },
            events: {
                onStateChange: onPlayerStateChange
            }
        });
    }

    function startMusic() {
        const link = document.getElementById("ytLink").value;
        const videoId = extractVideoId(link);

        if (!videoId) {
            alert("Link YouTube kh√¥ng h·ª£p l·ªá!");
            return;
        }

        clearTimeout(stopTimer);

        player.loadVideoById(videoId);

        // M·ªû TI·∫æNG (B·∫ÆT BU·ªòC)
        setTimeout(() => {
            player.unMute();
            player.setVolume(100);
        }, 500);

        document.getElementById("status").innerText =
            "üé∂ ƒêang ph√°t (l·∫∑p trong 1 ti·∫øng)";

        // D·ª™NG SAU 1 TI·∫æNG
        stopTimer = setTimeout(() => {
            stopMusic();
            document.getElementById("status").innerText =
                "‚è∞ H·∫øt 1 ti·∫øng, ƒë√£ d·ª´ng";
        }, 3600000);
    }

    function replayMusic() {
        player.seekTo(0);
        player.playVideo();
        document.getElementById("status").innerText =
            "üîÅ Ph√°t l·∫°i b√†i nh·∫°c";
    }

    function stopMusic() {
        clearTimeout(stopTimer);
        if (player) player.stopVideo();
        document.getElementById("status").innerText =
            "‚èπ ƒê√£ d·ª´ng";
    }

    function onPlayerStateChange(event) {
        // H·∫øt b√†i ‚Üí ph√°t l·∫°i (trong 1 ti·∫øng)
        if (event.data === YT.PlayerState.ENDED) {
            player.playVideo();
        }
    }
</script>

</body>
</html>
